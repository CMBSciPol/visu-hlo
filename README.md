<div align="center">
<img src="https://raw.githubusercontent.com/CMBSciPol/visu-hlo/main/docs/source/_static/logo.svg" alt="VISU-HLO" width="70%">
</div>


# Visualizing HLO computation graphs

[![PyPI version](https://badge.fury.io/py/visu-hlo.svg)](https://badge.fury.io/py/visu-hlo)
[![Python versions](https://img.shields.io/pypi/pyversions/visu-hlo)](https://pypi.org/project/visu-hlo/)
[![Continuous integration](https://github.com/CMBSciPol/visu-hlo/actions/workflows/ci.yml/badge.svg)](https://github.com/CMBSciPol/visu-hlo/actions/workflows/ci.yml)
[![Documentation](https://readthedocs.org/projects/visu-hlo/badge/?version=latest)](https://visu-hlo.readthedocs.io/en/latest/?badge=latest)

**visu-hlo** is a Python package that displays the HLO (High Level Operations) representation of JAX functions as SVG visualizations. This tool helps developers understand the computational graphs generated by JAX compilation.

## Features

- üéØ **Easy Visualization**: Display HLO graphs with a single function call
- ‚ö° **JIT Support**: Works with both regular and jitted JAX functions
- üñºÔ∏è **SVG Output**: High-quality vector graphics that scale perfectly
- üñ•Ô∏è **Cross-Platform**: Supports Linux, macOS, and Windows
- üì¶ **Lightweight**: Minimal dependencies - just JAX and Graphviz


## Quick Example

```python
import jax.numpy as jnp
from visu_hlo import show

# Display optimized HLO (default)
show(lambda x: 3 * x * 2, jnp.ones(10))
```

<div align="center">
<img src="https://raw.githubusercontent.com/CMBSciPol/visu-hlo/main/docs/source/_static/hlo_optimized.svg" alt="Optimized HLO" width="50%">
</div>

To display the non-optimized HLO:
```python
show(lambda x: 3 * x * 2, jnp.ones(10), jit=False)
```

<div align="center">
<img src="https://raw.githubusercontent.com/CMBSciPol/visu-hlo/main/docs/source/_static/hlo_not_optimized.svg" alt="Non-optimized HLO" width="50%">
</div>

To save as an SVG file:
```python
from visu_hlo import write_svg
write_svg('graph.svg', func, jnp.ones(10))
```

## Installation

```bash
pip install visu-hlo
```

**System dependency:** Install [Graphviz](https://graphviz.org/download/)

## Documentation

Full documentation: https://visu-hlo.readthedocs.io/

## License

MIT
